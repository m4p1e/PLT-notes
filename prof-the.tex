\documentclass{article}

\usepackage{ctex}
\usepackage{tikz}
\usetikzlibrary{cd}

%冲突nthm
%\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools} %for :=
\usepackage{stmaryrd} %for double square bracket

%\usepackage{unicode-math}
%\usepackage{chngcntr}
\usepackage{hyperref} %url
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    pdftitle={Overleaf Example},
    pdfpagemode=FullScreen,
    }


\usepackage[textwidth=18cm]{geometry} % 设置页宽=18

\usepackage{blindtext}
\usepackage{bm}
\parindent=0pt
\setlength{\parindent}{2em} 
\usepackage{indentfirst}

\usepackage{listings}
%\usepackage{minted}% hightlighting

\usepackage{proof} % infer

\usepackage{xcolor}
\usepackage{titlesec}
\titleformat{\section}[block]{\color{blue}\Large\bfseries\filcenter}{}{1em}{}
\titleformat{\subsection}[hang]{\color{red}\Large\bfseries}{}{0em}{}
%\setcounter{secnumdepth}{1} %section 序号


\usepackage[thmmarks, thref, amsmath]{ntheorem}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}

\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{example}[theorem]{Example}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{exercise}{Exercise}[section]
\newtheorem{annotation}[theorem]{Annotation}

\theoremheaderfont{\itshape}
\theorembodyfont{\upshape}
\newtheorem{case}{Case}

\theoremstyle{nonumberplain}
\theoremheaderfont{\scshape}
\theorembodyfont{\upshape}
\theoremsymbol{\scshape Q. E. D.}
\theorempostwork{\setcounter{case}{0}}
\newtheorem{proof}{Proof}

%\newtheorem{theorem}{Theorem}[section]
%\newtheorem{case}{Case}
%\newtheorem{subcase}{Case}
%\numberwithin{subcase}{case}

\newcommand*{\xfunc}[4]{{#2}\colon{#3}{#1}{#4}}
\newcommand*{\func}[3]{\xfunc{\to}{#1}{#2}{#3}}

\newcommand\Set[2]{\{\,#1\mid#2\,\}} %集合
\newcommand\SET[2]{\Set{#1}{\text{#2}}} %

\newcommand{\inl}[1]{\ensuremath{\text{inl}~#1}}
\newcommand{\inr}[1]{\ensuremath{\text{inr}~#1}}
\newcommand{\fold}[1]{\ensuremath{{fold}_{#1}}}
\newcommand{\unfold}[1]{\ensuremath{{unfold}_{#1}}}
\newcommand{\lam}[2]{\ensuremath{\lambda #1\ldotp~ #2}} %lamx.y
\newcommand{\pair}[1]{\ensuremath{\left\langle#1\right\rangle}}
\newcommand{\projone}[1]{\ensuremath{#1.1}}
\newcommand{\projtwo}[1]{\ensuremath{#1.2}}
\newcommand{\caseof}[3]{\ensuremath{{\textbf{case}}~#1~{\textbf{of}}~\inl{x_1}\mapsto #2\mid\inr{x_2}\mapsto #3}}
\newcommand{\Lam}[2]{\ensuremath{\Lambda #1\ldotp #2}}
\newcommand{\pack}[3]{\ensuremath{{pack}~\pair{#1,#2}~{as}~#3}}
\newcommand{\unpack}[4]{\ensuremath{{unpack}~#1~{as}~\pair{#2,#3}~{in}~#4}}
\newcommand{\assign}[2]{\ensuremath{#1~\coloneqq~#2}}
\newcommand{\singletype}[1]{\text{#1}}
\newcommand{\termtype}[2]{\ensuremath{#1:#2}}
\newcommand{\type}[3]{\ensuremath{ \left\{#1:#2\relmiddle|#3 \right\}}}
\newcommand{\matgen}[2]{\ensuremath{\mu #1\ldotp#2}} %ux.y
\newcommand{\mat}[0]{\matgen{\alpha}{\tau}} %ua.t
\newcommand{\fatgen}[2]{\ensuremath{\forall #1\ldotp#2}}
\newcommand{\fat}[0]{\fatgen{\alpha}{\tau}}
\newcommand{\eatgen}[2]{\ensuremath{\exists #1\ldotp#2}}
\newcommand{\eat}[0]{\eatgen{\alpha}{\tau}}
\newcommand{\fatgent}[2]{\ensuremath{\trgb{\forall} #1\ldotp#2}}
\newcommand{\fatt}[0]{\fatgent{\alpt}{\tat}}
\newcommand{\eatgent}[2]{\ensuremath{\trgb{\exists} #1\ldotp#2}}
\newcommand{\eatt}[0]{\eatgent{\alpt}{\tat}}

\newcommand{\fail}[0]{\mi{fail}}

\newcommand{\bnfdef}[0]{\ensuremath{\mathrel{::=}}} %::=
\newcommand{\term}[1]{\ensuremath\mathsf{#1}}
\newcommand{\true}{\term{true}}
\newcommand{\false}{\term{false}}
\newcommand{\ifelse}[3]{\ensuremath{\textbf{if}~#1~\textbf{then}~#2~\textbf{else}~#3}}
\newcommand{\succt}[1]{\term{succ}~#1}
\newcommand{\pred}[1]{\term{pred}~#1}
\newcommand{\iszero}[1]{\term{iszero}~#1}
\newcommand{\seq}[2]{#1;#2}
\newcommand{\subtyp}[2]{#1<:#2}


\newcommand{\redt}[1]{\textcolor{red}{#1}}
\newcommand{\bluet}[1]{\textcolor{blue}{#1}}
\newcommand{\abracket}[1]{\ensuremath{\left< #1 \right>}}
\newcommand{\dbracket}[1]{\ensuremath{\left\llbracket\,\vcenter{\hbox{$#1$}}\,\right\rrbracket}}

\begin{document}
\title{Proof Theory}
\author{枫聆}
\maketitle
\tableofcontents


\newpage
\section{Basic Logic}

\subsection{Satisfiability of Sets of Formulas}

\begin{definition}
\rm If $v$ is a \redt{valuation}, this is, a mapping from the atoms to the set $\{t,f\}$.   
\end{definition}


\begin{definition}
\rm \cite{cs245-sat} Let $\Sigma$ denote a set of well-formed formulas and $t$ a valuation. Define 
$$
\Sigma^t = \left\{
\begin{aligned}
T &&& \text{if for each}~\beta \in \Sigma, \beta^t = T \\
F &&& \text{otherwise}
\end{aligned}\right.
$$
When $\Sigma^t = T$, we say that $t$ \redt{satisfies} $\Sigma$. A set $\Sigma$ is \redt{satisfiable} iff there is some valuation $t$ such that $\Sigma^t = T$. 
\end{definition}


\begin{definition}
\rm Let $\Sigma$ be a set of formulas, and let $\alpha$ be a formula, we say that 
\begin{enumerate}
	\item $\alpha$ is a \redt{logical consequence} of $\Sigma$, or
	\item $\Sigma$ \redt{(semantically) entails} $\alpha$, or
	\item $\Sigma \models \alpha$,
\end{enumerate}
if and only if for all truth valuations $t$, if $\Sigma^t = T$ then also $\alpha^t = T$. We write $\Sigma \nvDash \alpha$ for there exists a truth valuation $t$ such that $\Sigma^t = T$ and $\alpha^t = F$. 
\end{definition}


\newpage
\section{Natural Deduction}

\begin{remark}
\rm \redt{Natural deduction is a kind of proof calculus in which logical reasoning is expressed by inference rules closely related to the "natural" way of reasoning}. 
\end{remark}

\subsection{Judgments and Propositions}

\begin{definition}
\rm A \emph{judgment} is somthing we may know, this is, an object of knowledge. A judgment is \emph{evident} if we in fact know it.
\end{definition}

\begin{annotation}
\rm "A is false" (see classical logic), "A is true at time t" (see temporal logic), "A is necessarily true" or "A is possibly true" (see modal logic), "the program M has type τ" (see programming languages and type theory), "A is achievable from the available resources" (see linear logic). 
\end{annotation}

%inference rule 写一遍没意思

\subsection{Introduction and Elimination}

\begin{definition}
\rm Inference rules that introduce a logical connective is the conclusion are known as \emph{introduction rules}. i.e., to conclude "$A~\text{and}~B~true$" for propositions $A$ and $B$, one requires evidence for "$A~true$" and $B~true$. As an inference rule:
$$
\infer[\wedge I]{A \wedge B ~true}{A~true & B~true}
$$
Here $\wedge I$ stands for "conjunction introduction".
\end{definition}

\begin{definition}
\rm Inference rules that describe how to deconstruct information about a compound proposition into information about its consitiuents are elimination rules. i.e., from $A \wedge B~true$, we can conclude $A~true$ and $B~true$:
$$
\infer[\wedge E_L]{A~true}{A \wedge B ~true}~~~~~~\infer[\wedge E_R]{B~true}{A \wedge B ~true} 
$$
\end{definition}

\begin{annotation}
\rm The meaning of conjunction is determinded by its \emph{verifications}.  
\end{annotation}

\subsection{Hypothetical Derivations}

\begin{definition}
\rm A \emph{hypothetical judgment} is $J_1, \cdots, J_n \vdash J$, where judgments $J_1,\cdots,J_n$ are unproved assumptions, and the judgment $J$ is the conclusion. A \emph{hypothetical deduction}(derivation) for $J_1, \cdots, J_n \vdash J$ has the form 
$$
\deduce[\vdots]{\raisebox{-1.0em}{$J$}}{J_1 & \cdots & J_n}
$$
which means $J$ is derivable from $J_1, \cdots, J_n$. 
\end{definition}

\begin{annotation}
\rm 上面的$J_1,\cdots,J_2$都可以替换成关于$J_i$的一个hypothetical derivation. 
\end{annotation}


\begin{definition}
\rm In the natural deduction calculus, an assumption is discharged when the conclusion of an inference does not depend on it, although one of the premises of the inference does\cite{tln}.
\end{definition}

\begin{annotation}
\rm Once the appropriate rules have been completed, these are known as discharged assumptions, and are not included in the pool of assumptions on which the conclusion of the rule depends\cite{discharged-proofwiki}.
\end{annotation}

\begin{annotation}
\rm hypothetical derivation要求最后的conclusion依赖的poof of assumptions不是空的. 
\end{annotation}

\begin{theorem}
\rm \redt{Deduction theorem} \[T, P \vdash Q \iff T \vdash P \to Q\].
\end{theorem}

\begin{annotation}
\rm 在deduction theorem中我们注意到第一个hypothetical judgment里面的antecedent $Q$被去掉了，在第二个hypothetical judgment的succedent里面作为一个implication的antecedent出现了，这里我们就可以说assumption $Q$ is discharged，即现在的conclusion已经不依赖它了. 那么我们是如何构造deduction theorem里面的implication的呢？ 下面接着看
\end{annotation}

\begin{definition}
\rm (\redt{implication}) If $B$ is true under the assumption that $A$ is true, formly written $A \supset B$. The corresponed introduction and elimination rule as follow \[\infer[\supset\!\!I^u]{A \supset B~true}{\deduce[\vdots]{B~true}{\infer[u]{A~true}{}}}~~~~~ \infer[\supset\!\!E]{B~true}{A\supset B & A~true}\]
\end{definition}

\begin{annotation}
\rm \redt{Why indexed $u$} In the introduction rule, the antecedent named $u$ is discharged in the conclusion. This is a mechanism for delimiting the scope of the hypothesis: its sole reason for existence is to establish "$B~true$"; it cannot be used for any other purpose, and in particular, it cannot be used below the introduction.

上面这段话出自natural deduction的wiki，这个$u$scope了assumption $A~true$的开端，因为$A\supset B$并不依赖$A~true$, 它描述只是if $A~true$ then $B~true$. 
同时最后的introduction rule会将这个assumption $A~true$ discharged掉，表示scope在这里已经结束了. 而implication rule会将上述derivation直接总结得到一个结论，即
$$
A \vdash B \Rightarrow \cdot\vdash A \to B. 
$$
\end{annotation}

\begin{example}
\rm Considering the following proof of $A \supset (B \supset (A \wedge B))$
$$
\infer[I^u]{A \supset (B \supset (A \wedge B))~true}{\infer[I^w]{B \supset (A \wedge B)~true}{\infer[\wedge I]{A \wedge B~true}{\infer[u]{A~true}{} & \infer[w]{B~true}{}}}}.
$$

这整个derivation不是hypothetical的，因为两个assumptions $A~true$和$B~true$都已经被discharged，因此它实际上一个complete proof! 
\end{example}

\begin{definition}
\rm (\redt{disjunction}) The elimination rule for disjunction:
$$
\infer[\vee E^{u,w}]{C~true}{A \vee B ~true & \deduce[\vdots]{C~true}{\infer[u]{A~true}{}} & \deduce[\vdots]{C~true}{\infer[w]{B~true}{}}}
$$
both assumption $u,w$ are discharged at the disjunction elimination rule. 
\end{definition}


\begin{definition}
\rm The falsehood elimination rule:
$$
\infer[\perp\!\!E]{C~true}{\perp~true}
$$
\end{definition}

\begin{annotation}
\rm falsehood可以看做一个zero-ary disjunction, 啥都不用考虑直接可以得到任意的conclusion？？？ There is no proof for $\perp~true$, so its sound to conclude arbitrary propositions. 
\end{annotation}

\newpage
\subsection{Harmony}

\begin{definition}
\rm \redt{Local soundness} shows that the elimination rules are not strong: no matter how we apply eliminations rules to the result of an introduction we cannot gain any new information.
\end{definition}

\begin{definition}
\rm \redt{Local completeness} shows that the elimination rules are not weak: there is alwayws a way to apply elimination rules so that we can reconstitute a proof of the original proposition from the the results by apply intruduction ruls. 
\end{definition}

\begin{annotation}
\rm local soundness告诉你通过elimination压缩得到的东西不会比你已经知道的东西强(not strong)，而local completeness告诉你合并通过elimination压缩得到的东西会得到全部你知道的信息. 
\end{annotation}


\begin{definition}
\rm Given two deduction of same judgment, we use the notion
$$
\deduce{A~true}{\mathcal{D}} \Longrightarrow_{R} \deduce{A~true}{\mathcal{D'}} 
$$
for the \redt{local reduction} of a deduction $\mathcal{D}$ to another deduction $D'$ of same judgement $A~true$. Simliarly, we have \redt{local expansion}
$$
\deduce{A~true}{\mathcal{D}'} \Longrightarrow_{E} \deduce{A~true}{\mathcal{D}}
$$
\end{definition}


\begin{definition}
\rm (\redt{substitution Principle}) If 
$$
\deduce[\mathcal{E}]{C~true}{\infer[u]{A~true}{}}
$$
is a hypothetical proof of $\mathcal{C}~true$ under the undischarged hypothesis $A~true$ labelled $u$, and 
$$
\deduce{A~true}{\mathcal{D}}
$$
is a proof of $A~true$ then
$$
\deduce[\mathcal{E}]{C~true}{\infer[u]{A~true}{\mathcal{D}}}
$$
is our notation for substituting $\mathcal{D}$ for all uses of the hypothesis labelled $u$ in $\mathcal{E}$. This deduction, also sometime written as $[\mathcal{D}/u]\mathcal{E}$ no longer depends on $u$.  
\end{definition}


\begin{example}
\rm If given a elimination rule of disjunction as follow
$$
\infer[\vee\!E_L]{A~true}{A \vee B~true}
$$
The rule a little bit stronger, since we would not be able to reduce
$$
\infer[\vee\!E_L]{A~true}{\infer[\vee\!I_R]{A \vee B~true}{B~true}}
$$
As u can see it's not local soundness. 
\end{example}


%\begin{definition}
%\rm The \redt{soundness} of proof system will assure that we can %only construct proofs of vaild arguments. That is, we want to %prove that every sentence in a proof is entailed by previous %sentenses. 
%\end{definition}

%Godel
%\begin{definition}
%\rm A deduction system is said to be complete if every %universally valid formula in the language $L$ has a proof under %the proof system.
%\end{definition}




\newpage
\subsection{Verifications and Uses}

\begin{definition}
\rm a verification should be a proof that only analyzes the consitituents of a proposition.
\end{definition}

\begin{annotation}
\rm natural deduction实际上像constructive logic或者intuitive logic,  不像classic logic, 例如Proposition $A \vee (A \supset B)$在classic logic就是正确的，因为我们$A$和$B$都需要给定是true/false tag, 但是在natural deduction里面我们好像没有办法来处理. 更甚，如果我们要证明一个$B$是accpeted in natural deduction, 你可能首先需要证明$A \supset B$和$B$都是accepted，就是根据结构来做derivation. 
\end{annotation}


\begin{definition}
\rm Writing $A\uparrow$ for the judgment "A has a verification". Naturally, this should mean that $A$ is true,  and that the evidence for that has a special form.
\end{definition}

\begin{definition}
\rm Writing $A\downarrow$ for the judgment "A may be used". $A\downarrow$ should be the case when either $A~true$ is a hypothesis, or $A$ is deduced from a hypothesis via elimination rules. 
\end{definition}

\begin{definition}
\rm For conjunction. 
$$
\begin{aligned}
&\infer[\wedge I]{A \wedge B\uparrow}{A \uparrow & B \uparrow} &&& \infer[\wedge E_L]{A \downarrow}{A \wedge B \downarrow} &&&& \infer[\wedge E_R]{B \downarrow}{A \wedge B \downarrow}
\end{aligned}
$$
\end{definition}


\begin{definition}
\rm For implication
$$
\begin{aligned}
&\infer[\supset^u]{A \supset B \uparrow}{\deduce[\vdots]{B\uparrow}{\infer[u]{A\downarrow}{}}} &&& \infer[\supset E]{B \downarrow}{A \supset B \downarrow & A \uparrow}
\end{aligned}
$$
implication introduction rule里面的$B \uparrow$表示没看懂，因为这里的$B$显然是来自elimination的结果. 为什么implication elimination里面需要$A \uparrow$呢?
\end{definition}

\begin{example}
\rm 
$$
\infer[\supset I^u]{(A \wedge B) \supset A~true}{\infer[\wedge E_L]{A~true}{\infer[u]{A\wedge B~true}{}}}
$$
\end{example}


\begin{definition}
\rm For disjunction
$$
\begin{aligned}
&\infer[\vee I_L]{A \vee B \uparrow}{A \uparrow} &&& \infer[\vee I_R]{A \vee B \uparrow}{B \uparrow} &&&  \infer[\vee E^{u,w}]{C \uparrow}{A \vee B \downarrow & \deduce[\vdots]{C\uparrow}{\infer[u]{A\uparrow}{}} & \deduce[\vdots]{C\uparrow}{\infer[w]{B\downarrow}{}}}
\end{aligned}
$$
\end{definition}


\begin{definition}
\rm For truth and falsehood.
$$
\begin{aligned}
& \infer[\top I]{\top \uparrow}{} &&& \infer[\perp E]{C\uparrow}{\perp \downarrow}
\end{aligned}
$$
\end{definition}

\begin{annotation}
\rm $\perp \downarrow$ signifies a contradiction from our hypotheses.
\end{annotation}

\begin{definition}
\rm For atomic propositions.
$$
\infer[\downarrow\uparrow]{P \uparrow}{P \downarrow}.
$$
\end{definition}

\begin{annotation}
\rm 对于atomic props，我们只能对它赋予一个property，没有关于它的verification. 因此上述的规则是在进行一个转换，只要我们assumption了关于它的一个property，就默认它已经被verified. 
\end{annotation}



\newpage
\subsection{Curry-Howard Conrrespondence}


\newpage
\begin{thebibliography}{00}
\bibitem{tln} John Slaney. The Logic Notes. \url{http://users.cecs.anu.edu.au/~jks/LogicNotes/}
\bibitem{discharged-stack} The relation between deduction theorem and discharged. \url{https://math.stackexchange.com/questions/3527285/what-does-discharging-an-assumption-mean-in-natural-deduction}
\bibitem{discharged-proofwiki} Definition:Discharged Assumption. \url{https://proofwiki.org/wiki/Definition:Discharged_Assumption}
\bibitem{cs245-sat} Propositional Logic: Semantics. \url{https://cs.uwaterloo.ca/~cbruni/CS245Resources/lectures/2018_Fall/05_Propositional_Logic_Semantics_Continued_post.pdf}
\end{thebibliography}
\end{document}