\documentclass{article}

\usepackage{ctex}
\usepackage{tikz}
\usetikzlibrary{cd}

%冲突nthm
%\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools} %for :=
\usepackage{stmaryrd} %for double square bracket

%\usepackage{unicode-math}
%\usepackage{chngcntr}
\usepackage{hyperref} %url
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    pdftitle={Overleaf Example},
    pdfpagemode=FullScreen,
    }


\usepackage[textwidth=18cm]{geometry} % 设置页宽=18

\usepackage{blindtext}
\usepackage{bm}
\parindent=0pt
\setlength{\parindent}{2em} 
\usepackage{indentfirst}

\usepackage{listings}
%\usepackage{minted}% hightlighting

\usepackage{proof} % infer

\usepackage{xcolor}
\usepackage{titlesec}
\titleformat{\section}[block]{\color{blue}\Large\bfseries\filcenter}{}{1em}{}
\titleformat{\subsection}[hang]{\color{red}\Large\bfseries}{}{0em}{}
%\setcounter{secnumdepth}{1} %section 序号


\usepackage[thmmarks, thref, amsmath]{ntheorem}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}

\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{example}[theorem]{Example}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{exercise}{Exercise}[section]
\newtheorem{annotation}[theorem]{Annotation}

\theoremheaderfont{\itshape}
\theorembodyfont{\upshape}
\newtheorem{case}{Case}

\theoremstyle{nonumberplain}
\theoremheaderfont{\scshape}
\theorembodyfont{\upshape}
\theoremsymbol{\scshape Q. E. D.}
\theorempostwork{\setcounter{case}{0}}
\newtheorem{proof}{Proof}

%\newtheorem{theorem}{Theorem}[section]
%\newtheorem{case}{Case}
%\newtheorem{subcase}{Case}
%\numberwithin{subcase}{case}

\newcommand*{\xfunc}[4]{{#2}\colon{#3}{#1}{#4}}
\newcommand*{\func}[3]{\xfunc{\to}{#1}{#2}{#3}}

\newcommand\Set[2]{\{\,#1\mid#2\,\}} %集合
\newcommand\SET[2]{\Set{#1}{\text{#2}}} %

\newcommand{\inl}[1]{\ensuremath{\text{inl}~#1}}
\newcommand{\inr}[1]{\ensuremath{\text{inr}~#1}}
\newcommand{\fold}[1]{\ensuremath{{fold}_{#1}}}
\newcommand{\unfold}[1]{\ensuremath{{unfold}_{#1}}}
\newcommand{\lam}[2]{\ensuremath{\lambda #1\ldotp~ #2}} %lamx.y
\newcommand{\pair}[1]{\ensuremath{\left\langle#1\right\rangle}}
\newcommand{\projone}[1]{\ensuremath{#1.1}}
\newcommand{\projtwo}[1]{\ensuremath{#1.2}}
\newcommand{\caseof}[3]{\ensuremath{{\textbf{case}}~#1~{\textbf{of}}~\inl{x_1}\mapsto #2\mid\inr{x_2}\mapsto #3}}
\newcommand{\Lam}[2]{\ensuremath{\Lambda #1\ldotp #2}}
\newcommand{\pack}[3]{\ensuremath{{pack}~\pair{#1,#2}~{as}~#3}}
\newcommand{\unpack}[4]{\ensuremath{{unpack}~#1~{as}~\pair{#2,#3}~{in}~#4}}
\newcommand{\assign}[2]{\ensuremath{#1~\coloneqq~#2}}
\newcommand{\singletype}[1]{\text{#1}}
\newcommand{\termtype}[2]{\ensuremath{#1:#2}}
\newcommand{\type}[3]{\ensuremath{ \left\{#1:#2\relmiddle|#3 \right\}}}
\newcommand{\matgen}[2]{\ensuremath{\mu #1\ldotp#2}} %ux.y
\newcommand{\mat}[0]{\matgen{\alpha}{\tau}} %ua.t
\newcommand{\fatgen}[2]{\ensuremath{\forall #1\ldotp#2}}
\newcommand{\fat}[0]{\fatgen{\alpha}{\tau}}
\newcommand{\eatgen}[2]{\ensuremath{\exists #1\ldotp#2}}
\newcommand{\eat}[0]{\eatgen{\alpha}{\tau}}
\newcommand{\fatgent}[2]{\ensuremath{\trgb{\forall} #1\ldotp#2}}
\newcommand{\fatt}[0]{\fatgent{\alpt}{\tat}}
\newcommand{\eatgent}[2]{\ensuremath{\trgb{\exists} #1\ldotp#2}}
\newcommand{\eatt}[0]{\eatgent{\alpt}{\tat}}

\newcommand{\fail}[0]{\mi{fail}}

\newcommand{\bnfdef}[0]{\ensuremath{\mathrel{::=}}} %::=
\newcommand{\term}[1]{\ensuremath\mathsf{#1}}
\newcommand{\true}{\term{true}}
\newcommand{\false}{\term{false}}
\newcommand{\ifelse}[3]{\ensuremath{\textbf{if}~#1~\textbf{then}~#2~\textbf{else}~#3}}
\newcommand{\succt}[1]{\term{succ}~#1}
\newcommand{\pred}[1]{\term{pred}~#1}
\newcommand{\iszero}[1]{\term{iszero}~#1}
\newcommand{\seq}[2]{#1;#2}
\newcommand{\subtyp}[2]{#1<:#2}


\newcommand{\redt}[1]{\textcolor{red}{#1}}
\newcommand{\bluet}[1]{\textcolor{blue}{#1}}
\newcommand{\abracket}[1]{\ensuremath{\left< #1 \right>}}
\newcommand{\dbracket}[1]{\ensuremath{\left\llbracket\,\vcenter{\hbox{$#1$}}\,\right\rrbracket}}

\begin{document}
\title{Proof Theory}
\author{枫聆}
\maketitle
\tableofcontents


\newpage
\section{Basic Logic}

\subsection{Satisfiability of Sets of Formulas}

\begin{definition}
\rm If $v$ is a \redt{valuation}, this is, a mapping from the atoms to the set $\{t,f\}$.   
\end{definition}


\begin{definition}
\rm \cite{cs245-sat} Let $\Sigma$ denote a set of well-formed formulas and $t$ a valuation. Define 
$$
\Sigma^t = \left\{
\begin{aligned}
T &&& \text{if for each}~\beta \in \Sigma, \beta^t = T \\
F &&& \text{otherwise}
\end{aligned}\right.
$$
When $\Sigma^t = T$, we say that $t$ \redt{satisfies} $\Sigma$. A set $\Sigma$ is \redt{satisfiable} iff there is some valuation $t$ such that $\Sigma^t = T$. 
\end{definition}


\begin{definition}
\rm Let $\Sigma$ be a set of formulas, and let $\alpha$ be a formula, we say that 
\begin{enumerate}
	\item $\alpha$ is a \redt{logical consequence} of $\Sigma$, or
	\item $\Sigma$ \redt{(semantically) entails} $\alpha$, or
	\item $\Sigma \models \alpha$,
\end{enumerate}
if and only if for all truth valuations $t$, if $\Sigma^t = T$ then also $\alpha^t = T$. We write $\Sigma \nvDash \alpha$ for there exists a truth valuation $t$ such that $\Sigma^t = T$ and $\alpha^t = F$. 
\end{definition}

\begin{annotation}
\rm For example, $\Sigma = \{p_1,p_2,\cdots,p_n\}$ could be a set of premises and let $\alpha$ could be the conclusion that we want to derive. 
\end{annotation}




\newpage
\section{Natural Deduction}

\begin{remark}
\rm \redt{Natural deduction is a kind of proof calculus in which logical reasoning is expressed by inference rules closely related to the "natural" way of reasoning}. 
\end{remark}

\subsection{Judgments and Propositions}

\begin{definition}
\rm A \emph{judgment} is somthing we may know, this is, an object of knowledge. A judgment is \emph{evident} if we in fact know it.
\end{definition}

\begin{annotation}
\rm "A is false" (see classical logic), "A is true at time t" (see temporal logic), "A is necessarily true" or "A is possibly true" (see modal logic), "the program M has type τ" (see programming languages and type theory), "A is achievable from the available resources" (see linear logic). 
\end{annotation}

%inference rule 写一遍没意思

\subsection{Introduction and Elimination}

\begin{definition}
\rm Inference rules that introduce a logical connective is the conclusion are known as \emph{introduction rules}. i.e., to conclude "$A~\text{and}~B~true$" for propositions $A$ and $B$, one requires evidence for "$A~true$" and $B~true$. As an inference rule:
$$
\infer[\wedge I]{A \wedge B ~true}{A~true & B~true}
$$
Here $\wedge I$ stands for "conjunction introduction".
\end{definition}

\begin{annotation}
\rm 实际上面的inference rule的general form应该是
$$
\infer[\wedge I]{A \wedge B ~true}{A~prog & B~prog & A~true & B~true}
$$
这里才能帮助后面的$\vDash$ make sense. 
\end{annotation}

\begin{definition}
\rm Inference rules that describe how to deconstruct information about a compound proposition into information about its consitiuents are elimination rules. i.e., from $A \wedge B~true$, we can conclude $A~true$ and $B~true$:
$$
\infer[\wedge E_L]{A~true}{A \wedge B ~true}~~~~~~\infer[\wedge E_R]{B~true}{A \wedge B ~true} 
$$
\end{definition}

\begin{annotation}
\rm The meaning of conjunction is determinded by its \emph{verifications}.  
\end{annotation}

\subsection{Hypothetical Derivations}

\begin{definition}
\rm A \emph{hypothetical judgment} is $J_1, \cdots, J_n \vdash J$, where judgments $J_1,\cdots,J_n$ are unproved assumptions, and the judgment $J$ is the conclusion. A \emph{hypothetical deduction}(derivation) for $J_1, \cdots, J_n \vdash J$ has the form 
$$
\deduce[\vdots]{\raisebox{-1.0em}{$J$}}{J_1 & \cdots & J_n}
$$
which means $J$ is derivable from $J_1, \cdots, J_n$. 
\end{definition}

\begin{annotation}
\rm 上面的$J_1,\cdots,J_2$都可以替换成关于$J_i$的一个hypothetical derivation. 
\end{annotation}


\begin{definition}
\rm In the natural deduction calculus, an assumption is discharged when the conclusion of an inference does not depend on it, although one of the premises of the inference does\cite{tln}.
\end{definition}

\begin{annotation}
\rm Once the appropriate rules have been completed, these are known as discharged assumptions, and are not included in the pool of assumptions on which the conclusion of the rule depends\cite{discharged-proofwiki}.
\end{annotation}

\begin{annotation}
\rm hypothetical derivation要求最后的conclusion依赖的poof of assumptions不是空的. 
\end{annotation}

\begin{theorem}
\rm \redt{Deduction theorem} \[T, P \vdash Q \iff T \vdash P \to Q\].
\end{theorem}

\begin{annotation}
\rm 在deduction theorem中我们注意到第一个hypothetical judgment里面的antecedent $Q$被去掉了，在第二个hypothetical judgment的succedent里面作为一个implication的antecedent出现了，这里我们就可以说assumption $Q$ is discharged，即现在的conclusion已经不依赖它了. 那么我们是如何构造deduction theorem里面的implication的呢？ 下面接着看
\end{annotation}

\begin{definition}
\rm (\redt{implication}) If $B$ is true under the assumption that $A$ is true, formly written $A \supset B$. The corresponed introduction and elimination rule as follow \[\infer[\supset\!\!I^u]{A \supset B~true}{\deduce[\vdots]{B~true}{\infer[u]{A~true}{}}}~~~~~ \infer[\supset\!\!E]{B~true}{A\supset B & A~true}\]
\end{definition}

\begin{annotation}
\rm \redt{Why indexed $u$} In the introduction rule, the antecedent named $u$ is discharged in the conclusion. This is a mechanism for delimiting the scope of the hypothesis: its sole reason for existence is to establish "$B~true$"; it cannot be used for any other purpose, and in particular, it cannot be used below the introduction.

上面这段话出自natural deduction的wiki，这个$u$scope了assumption $A~true$的开端，因为$A\supset B$并不依赖$A~true$, 它描述只是if $A~true$ then $B~true$. 
同时最后的introduction rule会将这个assumption $A~true$ discharged掉，表示scope在这里已经结束了. 而implication rule会将上述derivation直接总结得到一个结论，即
$$
A \vdash B \Rightarrow \cdot\vdash A \to B. 
$$
\end{annotation}

\begin{example}
\rm Considering the following proof of $A \supset (B \supset (A \wedge B))$
$$
\infer[I^u]{A \supset (B \supset (A \wedge B))~true}{\infer[I^w]{B \supset (A \wedge B)~true}{\infer[\wedge I]{A \wedge B~true}{\infer[u]{A~true}{} & \infer[w]{B~true}{}}}}.
$$

这整个derivation不是hypothetical的，因为两个assumptions $A~true$和$B~true$都已经被discharged，因此它实际上一个complete proof! 
\end{example}

\begin{definition}
\rm (\redt{disjunction}) The elimination rule for disjunction:
$$
\infer[\vee E^{u,w}]{C~true}{A \vee B ~true & \deduce[\vdots]{C~true}{\infer[u]{A~true}{}} & \deduce[\vdots]{C~true}{\infer[w]{B~true}{}}}
$$
both assumption $u,w$ are discharged at the disjunction elimination rule. 
\end{definition}


\begin{definition}
\rm The falsehood elimination rule:
$$
\infer[\perp\!\!E]{C~true}{\perp~true}
$$
\end{definition}

\begin{annotation}
\rm falsehood elimination的意义在哪？ 首先你应该主要到一个特殊等价命题$A \vee \perp = A$，从$\vee$的introduction rule来看这意味$\perp~true \vdash A~true$，由于$A$是任意的，因此我们得到了$\perp~true \vdash C~true$. 
\end{annotation}

\newpage
\subsection{Harmony}

\begin{definition}
\rm \redt{Local soundness} shows that the elimination rules are not strong: no matter how we apply eliminations rules to the result of an introduction we cannot gain any new information.
\end{definition}

\begin{definition}
\rm \redt{Local completeness} shows that the elimination rules are not weak: there is always a way to apply elimination rules so that we can reconstitute a proof of the original proposition from the the results by apply intruduction ruls. 
\end{definition}

\begin{annotation}
\rm local soundness告诉你通过elimination压缩得到的东西不会比你已经知道的东西强(not strong)，而local completeness告诉你合并通过elimination压缩得到的东西会得到全部你知道的信息. 
\end{annotation}


\begin{definition}
\rm Given two deduction of same judgment, we use the notion
$$
\deduce{A~true}{\mathcal{D}} \Longrightarrow_{R} \deduce{A~true}{\mathcal{D'}} 
$$
for the \redt{local reduction} of a deduction $\mathcal{D}$ to another deduction $D'$ of same judgement $A~true$. Simliarly, we have \redt{local expansion}
$$
\deduce{A~true}{\mathcal{D}'} \Longrightarrow_{E} \deduce{A~true}{\mathcal{D}}
$$
\end{definition}


\begin{definition}
\rm (\redt{substitution Principle}) If 
$$
\deduce[\mathcal{E}]{C~true}{\infer[u]{A~true}{}}
$$
is a hypothetical proof of $\mathcal{C}~true$ under the undischarged hypothesis $A~true$ labelled $u$, and 
$$
\deduce{A~true}{\mathcal{D}}
$$
is a proof of $A~true$ then
$$
\deduce[\mathcal{E}]{C~true}{\infer[u]{A~true}{\mathcal{D}}}
$$
is our notation for substituting $\mathcal{D}$ for all uses of the hypothesis labelled $u$ in $\mathcal{E}$. This deduction, also sometime written as $[\mathcal{D}/u]\mathcal{E}$ no longer depends on $u$.  
\end{definition}


\begin{example}
\rm If given a elimination rule of disjunction as follow
$$
\infer[\vee\!E_L]{A~true}{A \vee B~true}
$$
The rule a little bit stronger, since we would not be able to reduce
$$
\infer[\vee\!E_L]{A~true}{\infer[\vee\!I_R]{A \vee B~true}{B~true}}
$$
As u can see it's not local soundness. 
\end{example}


%\begin{definition}
%\rm The \redt{soundness} of proof system will assure that we can %only construct proofs of vaild arguments. That is, we want to %prove that every sentence in a proof is entailed by previous %sentenses. 
%\end{definition}

%Godel
%\begin{definition}
%\rm A deduction system is said to be complete if every %universally valid formula in the language $L$ has a proof under %the proof system.
%\end{definition}




\newpage
\subsection{Verifications and Uses}

\begin{definition}
\rm a verification should be a proof that only analyzes the consitituents of a proposition.
\end{definition}

\begin{annotation}
\rm natural deduction实际上像constructive logic或者intuitive logic,  不像classic logic, 例如Proposition $A \vee (A \supset B)$在classic logic就是正确的，因为我们$A$和$B$都需要给定是true/false tag, 但是在natural deduction里面我们好像没有办法来处理. 更甚，如果我们要证明一个$B$是accpeted in natural deduction, 你可能首先需要证明$A \supset B$和$B$都是accepted，就需要根据其结构bottom-up来做derivation. 
\end{annotation}


\begin{definition}
\rm Writing $A\uparrow$ for the judgment "A has a verification". Naturally, this should mean that $A$ is true,  and that the evidence for that has a special form.
\end{definition}

\begin{definition}
\rm Writing $A\downarrow$ for the judgment "A may be used". $A\downarrow$ should be the case when either $A~true$ is a hypothesis, or $A$ is deduced from a hypothesis via elimination rules. 
\end{definition}

\begin{annotation}
\rm 上述两个definitions里面隐藏着非常重要但有点不正式的结论:If $A$ has a vertification then $A$ true, 反之依然. 后面我们将形式化地证明它们. 
\end{annotation}

\begin{definition}
\rm For conjunction. 
$$
\begin{aligned}
&\infer[\wedge I]{A \wedge B\uparrow}{A \uparrow & B \uparrow} &&& \infer[\wedge E_L]{A \downarrow}{A \wedge B \downarrow} &&&& \infer[\wedge E_R]{B \downarrow}{A \wedge B \downarrow}
\end{aligned}
$$
\end{definition}


\begin{definition}
\rm For implication
$$
\begin{aligned}
&\infer[\supset^u]{A \supset B \uparrow}{\deduce[\vdots]{B\uparrow}{\infer[u]{A\downarrow}{}}} &&& \infer[\supset E]{B \downarrow}{A \supset B \downarrow & A \uparrow}
\end{aligned}
$$
implication introduction rule里面的$B \uparrow$表示没看懂，因为这里的$B$显然是来自elimination的结果. 为什么implication elimination里面需要$A \uparrow$呢?
\end{definition}

\begin{example}
\rm 
$$
\infer[\supset I^u]{(A \wedge B) \supset A~true}{\infer[\wedge E_L]{A~true}{\infer[u]{A\wedge B~true}{}}}
$$
\end{example}


\begin{definition}
\rm For disjunction
$$
\begin{aligned}
&\infer[\vee I_L]{A \vee B \uparrow}{A \uparrow} &&& \infer[\vee I_R]{A \vee B \uparrow}{B \uparrow} &&&  \infer[\vee E^{u,w}]{C \uparrow}{A \vee B \downarrow & \deduce[\vdots]{C\uparrow}{\infer[u]{A\uparrow}{}} & \deduce[\vdots]{C\uparrow}{\infer[w]{B\downarrow}{}}}
\end{aligned}
$$
\end{definition}


\begin{definition}
\rm For truth and falsehood.
$$
\begin{aligned}
& \infer[\top I]{\top \uparrow}{} &&& \infer[\perp E]{C\uparrow}{\perp \downarrow}
\end{aligned}
$$
\end{definition}

\begin{annotation}
\rm $\perp \downarrow$ signifies a contradiction from our hypotheses.
\end{annotation}

\begin{definition}
\rm For atomic propositions.
$$
\infer[\downarrow\uparrow]{P \uparrow}{P \downarrow}.
$$
\end{definition}

\begin{annotation}
\rm 对于atomic props，我们只能对它赋予一个property，没有关于它的verification. 因此上述的规则是在进行一个转换，只要我们assume了关于它的一个property，就默认它已经被verified. 
\end{annotation}

\newpage
\subsection{Soundness and Completeness of Natural Deduction}

\begin{definition}
\rm \cite{cs245-nd}\redt{Soundness} of natural deduction means that the conclusion of proof is always a logical consequence of the premises. That is
$$
\text{If}~\Sigma \vdash \alpha, \text{then}~\Sigma \vDash \alpha. 
$$ 
\end{definition}


\begin{definition}
\rm \redt{Completeness} of natural deduction means that all logical consequences in propositional logic are provable in natural deduction. That is,
$$
\text{If}~\Sigma \vDash \alpha, \text{then}~\Sigma \vdash \alpha.
$$ 
\end{definition}

\begin{annotation}
\rm 其中$\Sigma \vdash \alpha$， 表示存在一个以$\Sigma$作为premise得到conclusion为$\alpha$的proof. 而$\Sigma \vDash \alpha$，就考虑两端的proposition加上truth-falsehood了， 即如$\Sigma^t = True$则有$\alpha^t = True$.

对于soundness的证明，我们需要根据$\alpha$的结构来做归纳，而后再考虑赋予其true/false来考虑. 这里记录一下对于结构归纳它是怎样对应一般归纳法命题$P(n)$结构上，这里的$n$应该对应$\alpha$的bottom-up derivation里面的maximum depth of line. 

而对于completeness的证明，相对来说会复杂一点. 我们需要下面3个lemma. 有一个疑问不引入negation是不是还说明不了completeness?
\end{annotation}

\begin{lemma}
\rm If $\Sigma =\{\alpha_0,\alpha_1,\cdots,\cdots,\alpha_n\} $ and $\Sigma \vDash \beta$, then
$$
\emptyset \vDash (\alpha_0 \to (\alpha_1 \to (\cdots \to (\alpha_n \to \beta)\cdots)).
$$
\end{lemma}

\begin{annotation}
\rm Deduction theorem体现的淋漓尽致，将$\beta$完美转换成了一个tautology. 
\end{annotation}

\begin{lemma}\label{how-to-construct-provable-formula}
\rm For any well-form formula $\gamma$ containing atoms $p_1,p_2,\cdots,p_n$ and any valuation $t$, we have 
\begin{enumerate}
	\item If $\gamma^t = True$ then $\widehat{p}_1,\widehat{p}_2,\cdots,\widehat{p}_n \vdash \gamma$;
	\item If $\gamma^t = False$ then $\widehat{p}_1,\widehat{p}_2,\cdots,\widehat{p}_n \vdash \neg\gamma$;
\end{enumerate}
where defines $\widehat{p}_i$ as follow
$$
\widehat{p}_i = \left\{
\begin{aligned}
&p_i && \text{if}~p_i^t = True \\
&\neg p_i && \text{if}~p_i^t = False
\end{aligned}
\right.
$$
\end{lemma}

\begin{example}
\rm 若$\gamma = p \to q$，我们可以构造一个真值表
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
$p$ & $q$ & $p \to q$ & Claim \\ 
$T$ & $T$ & $T$ & $p , q \vdash p \to q$ \\
$T$ & $F$ & $F$ & $p , \neg q \vdash \neg(p \to q)$ \\
$F$ & $T$ & $T$ & $\neg p , q \vdash p \to q$ \\
$F$ & $F$ & $T$ & $\neg p , \neg q \vdash p \to q$ \\ 
\hline
\end{tabular}
\end{center}
那么上面的claims是怎么来的呢？我们可以来分别证明, 对于第一行
$$
\infer[u]{p \to q~true}{\infer{q~true}{\infer[u]{p~true}{} & q~true}}
$$
感觉有点奇怪，这里需要用到vars inference rule, 这里相对于对$q \vdash p \to q$的weaken premise. 对于第二行
$$
\infer[u]{\neg (p \to q)~true}{\infer{\perp}{\infer{q}{\infer[u]{p \to q~true}{} & p~true} & \neg q ~true}}
$$
对于第三行
$$
\infer[u]{p \to q~true}{\infer{q~true}{\infer{\perp}{\infer[u]{p~true}{} & \neg p ~true}}}
$$
对于第四行，和第三行类似. 可以看的出来这个lemma非常深刻，\bluet{只要将atoms调整为在当前valuation下都是true的命题，结论再对应调整，就可以构造一个对应的proof}. 
\end{example}

\begin{lemma}\label{tautologies-are-provable}
\rm For any well-formed formula $\gamma$, if $\emptyset \vDash \gamma$, then $\emptyset \vdash \gamma$. 
\end{lemma}

\begin{annotation}
\rm Lemma \ref{tautologies-are-provable}一句话概况就是tautologies are provable. 其证明过程可以用Lemma \ref{how-to-construct-provable-formula}来说明. 现在$\gamma$是一个tautology，那么对于所有的valuation都有$\gamma^t = true$，这有什么用呢？ 这里还需要引入另外一种tautology $p \vee \neg p$，配合emilination rule of $vee$，即
$$
\infer{\gamma}{(p_1 \vee \neg p_1) & (p_2 \vee \neg p_2) & \cdots & (p_n \vee \neg p_n)&\deduce[\vdots]{\gamma}{\infer{}{\infer{p_1}{} & \cdots & \infer{p_n}{}}} & \cdots & \deduce[\vdots]{\gamma}{\infer{}{\infer{\neg p_1}{} & \cdots & \infer{\neg p_n}{}}}}
$$
这里需要考虑有$2^n$个cases，每一个对应一种valuation，又因为$\gamma$是tautology，因此最后的conclusion也都是$\gamma$. 
\end{annotation}

\begin{lemma}
\rm If $\emptyset \vdash (\alpha_0 \to (\alpha_1 \to (\cdots \to (\alpha_n \to \beta)\cdots))$, then $\{\alpha_0, \alpha_1,\cdots,\alpha_n\} \vdash \beta$, that is, $\Sigma \vdash \beta$. 
\end{lemma}

\newpage
\subsection{Notational Definition}

\begin{definition}
\rm A \redt{notational definition} gives the meaning of the general form of a proposition in terms of another proposition whose meaning has already been defined.
\end{definition}

\begin{example}
\rm We can define logical equivalence, written $A \equiv B$ as 
$$
(A \supset B) \wedge (B \supset A).
$$ 
\end{example}

\begin{example}
\rm We can define negation $\neg A$ as 
$$
\neg A = (A \supset \perp) \Longrightarrow \infer[\neg I]{\neg A}{\deduce[\vdots]{\perp}{A}}
$$
We also can give the introduction rule of falsehood.
$$
\infer[\perp I]{\perp}{\neg A & A}
$$
so $\perp$ actually means any contradictions. moreover double negation is coming.
\end{example}

\begin{annotation}
\rm notaional definition可以看做用已有的东西构造出一些东西. 与之对应的是我们可以直接符号化的给出某个新的定义，称之为symbolic definition. 
\end{annotation}

\newpage
\subsection{Derived Rules of Inference}

\begin{example}
\rm 
$$
\infer{A \supset C~true}{A \supset B~true & B \supset C~true}
$$
is a derived rule of inference. Its derivation is the following:
$$
\infer[\supset I^u]{A \supset C~true}{\infer[\supset E]{C~true}{B \supset C~true & \infer[\supset E]{B~true}{A \supset B~true & \infer[u]{A~true}{}}}}
$$
\end{example}

\begin{annotation}
\rm 关于derivation的推导这里有一些strategies在里面
\begin{itemize}
	\item 使用introduction rule从下至上，即我们想要什么;
	\item 使用elimination rule从上至下，即我们知道什么.
\end{itemize}
\end{annotation}

\begin{example}
\rm Modus tollens(这玩意不就是逆否命题)
$$
\infer[MT]{\neg A}{A \to B & \neg B}.
$$
\end{example}


\newpage
\subsection{Curry-Howard Conrrespondence}

\begin{definition}
\rm Curry-Howard correspondence is between the natural deduction and simply-typed $\lambda$-calculus at three levels
\begin{itemize}
	\item propositions are types;
	\item proofs are programs; and
	\item simplification of proofs is evaluation of programs.
\end{itemize}
That is
\begin{center}
\begin{tabular}{c|c}
Types & Propositions \\
\hline
Unit types (1) & Truth ($\top$)\\
\hline
Product type ($\times$) & Conjunction ($\wedge$) \\
\hline
Union type ($+$)& Disjunction ($\vee$) \\
\hline
Function type ($\to$) & Implication ($\supset$)\\
\hline
Void types (0) & False ($\perp$)
\end{tabular}
\end{center}
Every typing rule has a correspondence with a deduction rule. 
\end{definition}


\begin{example}
\rm The typing derivation of the term $\lam{a}{\lam{b}{\left<a,b\right>}}$ can be seen as a deduction tree proving $A \supset B \supset A \wedge B$.
\[
\begin{aligned}
	\infer[abs]{\Gamma\vdash\lam{x:A}{\lam{y:B}{\left<x,y\right>}}:A \to B \to A \times B}{\infer[abs]{\Gamma\vdash \lam{y:B}{\left<a,y\right>}:B \to A \times B}{\infer[pair]{\Gamma\vdash \left<a,b\right>: A \times B}{\infer[var]{\Gamma\vdash a:A}{a:A \in \Gamma} & \infer[var]{\Gamma\vdash b:B}{b:B \in \Gamma}}}} & \iff & 
	\infer[\supset I^u]{A \supset B \supset A \wedge B~true}{\infer[\supset I^w]{B \supset A \wedge B~true}{\infer[\wedge \wedge I]{A \wedge B ~true}{\infer[u]{A~true}{} & \infer[w]{B~true}{}}}}		
\end{aligned}
\]
\end{example}

\begin{annotation}
\rm 从上面例子中看的出来，the inference rule of natural deduction缺点什么，我也可以给原本每个inference rule都加上the annotation for proof terms. \cite{FP-pap}那么这里$M:A$有两种解释:
\begin{enumerate}
	\item $M$ is proof term for proposition $A$;
	\item $M$ is a program of type $A$. 
\end{enumerate}
这样解释Curry-Howard ismorphism或许方便一点. 让proof terms make sense: 我们有"if $M:A$ then $A~true$"，反过来"if $A~true$ then $M:A$". 例如我们可以将the proof term of $A \wedge B~true$看做一个pair包含两个subterm，一个关于$A~true$和另一个关于$B~true$.
$$
\infer[\wedge I]{\left<M,N\right>: A \wedge B}{M:A & N:B}
$$
那么the elimination rule of conjunction对应一个natural projection.
$$
\begin{aligned}
\infer[\wedge E_L]{\pi_1 M:A}{M:A \wedge B} &&& \infer[\wedge E_R]{\pi_2 M:B}{M:A \wedge B} 
\end{aligned}
$$ 
\end{annotation}


\begin{example}
\rm 通过Curry-Howard isomorphism我们可以将我们想要证明的judgment转换到type system中，你会看到非常的便利! 例如
$$
(A \supset (B \wedge C)) \supset (A \supset B) \wedge (A \supset C)~true
$$
等价于
$$
\lam{x}{\left<\lam{y}{\pi_1(x~y)},\lam{y}{\pi_2(x~y)} \right>}: (A \to B \times C) \to (A \to B) \times (A \to C)
$$
一个implication被转换成了对应的abstraction，此时我们肯定会想如果给一个false proposition是不是就转不了？ 例如
$$
(A \supset B) \supset (B \supset A)
$$
显然我们无法在现有type system构造出一个合理的abstraction使得$(A \to B) \to (B \to A)$.

迎面走来的问题是: 给定一个proposition true, 是否有其他的term with type和它对应呢？ 显然是有的，
$$
\lam{z}{\lam{x}{\left<\lam{y}{\pi_1(x~y)},\lam{y}{\pi_2(x~y)} \right>}}z'
$$
那这是不是违反Curry-Howard isomorphsim了呢？ 其实并不是，这里的对应是指proof terms和deduction of proposition true,  显然deduction变了，对应的proof terms也要变. 
\end{example}


\newpage
\section{More Delicate}

\subsection{Validity}

\begin{definition}
\rm $A~valid$ if $\bullet \vdash A~true$ where $\bullet$ is emphasizing that there are no truth hypotheses(different from $\cdot$ that represents empty collection of hypotheses), and we call $\bullet \vdash A~true$ is \redt{categorical judgement}. Written $\Delta A$ for reflecting the notion of validity as a proposition. 
\end{definition}

\begin{annotation}
\rm 其中$\square A$表示一个proposition claimed $A$ is vaild, 因此$\square A ~true$表示这个proposition成立. 那么关于它的introduction rule是什么？ 很自然地由$A ~ valid$的definition有
$$
\infer[\square I]{\Gamma \vdash \square A~true}{\bullet \vdash A~true}
$$
那么它的elimination rule又是什么呢？ 第一次尝试
$$
\infer[\square E]{\bullet \vdash A~true}{\Gamma \vdash \square A~true}
$$
看起来是local soundness，通过它得到的infos还行. 但是实际上有问题
$$
\infer[\square E]{\bullet \vdash A~true}{\infer{\square A~true \vdash \square A~true}{}}
$$
这等于我们可以no assumption推出所有proposition都是valid，因此这个elimination rule有点太强了. 那么我们考虑让它弱一点，第二次尝试
$$
\infer[\square E]{\Gamma \vdash A~true}{\Gamma \vdash \square A~true}
$$
这里确实是local soundness，但却不是local completeness
$$
\infer[?]{\Gamma \vdash \square A~true}{\infer[\square E]{\Gamma \vdash A~true}{\Gamma \vdash \square A~true}}
$$
我们得改变一下思路，如果$A~vaild$，那么其他premise包含$A~vaild$的judgement那么实际上都是可以去掉$A~vaild$，但也仅仅局限以此，这才是emilination故事的主线. 
\end{annotation}

\begin{definition}
\rm Then general judgement form
$$
\underbrace{u_1::B_1~vaild,\cdots,u_k::B_k~vaild}_{\Delta}; \underbrace{x_1:A_1~true,\cdots,x_n:A_n~true}_{\Gamma} \vdash C~true
$$
\end{definition}

\begin{definition}
\rm The introduction rule and elimination rule of $A~vaild$ as follow
$$
\begin{aligned}
\infer[\square I]{\Delta; \Gamma \vdash \square A~true}{\Delta; \bullet \vdash A~true} &&&& \infer[\square E]{\Delta;\Gamma \vdash C~true}{\Delta;\Gamma \vdash \square A~true & \Delta, u::A~vaild; \Gamma \vdash C~true}
\end{aligned}
$$
\end{definition}

\begin{theorem}
\rm Local soundness and local completeness of above introduction and elimination rule are held 
\end{theorem}

\begin{annotation}
\rm 可以看到emilination rule变成了substitution，而不是从单纯从本身要得到什么，后面会看见更多这样的东西. 
\end{annotation}


\begin{example}
\rm Proof of $\cdot;\cdot\vdash \square A \supset A$.
$$
\infer[\supset I^x]{\cdot;\cdot\vdash (\square A \supset A)~true}{\infer[\square E^u]{\cdot;x:\square A~true}{\infer[x]{\cdot;x:\square A~true \vdash \square A~true}{} & \infer[u]{u::A~vaild; x:\square A~true \vdash A~true}{}  }}
$$
\end{example}



\newpage
\subsection{Box is Powerful}

\begin{definition}
\rm $\square$ is $\square$. 
\end{definition}


\begin{definition}
\rm A term $\text{box} M$ means $M$ is a quated source expression such that there are not any free variables $x$. 
\end{definition}


\begin{definition}
\rm And $\square A$ is necessity modality. 
\end{definition}


\newpage
\subsection{Possibility}

\begin{definition}
\rm We use $\Diamond A$ for possibility modality.
\end{definition}

\begin{annotation}
\rm $\Diamond A$就是一个claim $A$ is possible的命题. 通常在classic modal logic里面我们定义$A$ is possible if its negation is not necessary, that is $\Diamond A = \neg \square \neg A$. 但是这种手法在现在我们讨论的intuitionistic logic无法奏效，我们希望的是有一个直观的introduction rule来得到它，也就是我们需要一些explicit evidences，一开始就它的negation那显然是做不到的. 
\end{annotation}

\begin{definition}
\rm \cite{15-816-ciom}The definition of possiblity.
$$
\infer[poss]{\Delta,\Gamma \vdash A~poss}{\Delta,\Gamma \vdash A~true}
$$
\end{definition}


\begin{definition}
\rm The introduction and emilination rule of possiblity.
$$
\begin{aligned}
\infer[\Diamond I]{\Delta;\Gamma \vdash \Diamond A~true}{\Delta;\Gamma \vdash A~poss} &&&&
\infer[\Diamond E]{\Delta;\Gamma \vdash C~poss}{\Delta;\Gamma \vdash \Diamond A~true & \Delta;x:A~true \vdash C~poss}
\end{aligned}
$$
\end{definition}

\begin{theorem}
\rm Local soundness and completeness are held. 
\end{theorem}

\begin{annotation}
\rm td;
\end{annotation}

\newpage
\begin{thebibliography}{00}
\bibitem{tln} John Slaney. The Logic Notes. \url{http://users.cecs.anu.edu.au/~jks/LogicNotes/}
\bibitem{discharged-stack} The relation between deduction theorem and discharged. \url{https://math.stackexchange.com/questions/3527285/what-does-discharging-an-assumption-mean-in-natural-deduction}
\bibitem{discharged-proofwiki} Definition:Discharged Assumption. \url{https://proofwiki.org/wiki/Definition:Discharged_Assumption}
\bibitem{cs245-sat} Propositional Logic: Semantics. \url{https://cs.uwaterloo.ca/~cbruni/CS245Resources/lectures/2018_Fall/05_Propositional_Logic_Semantics_Continued_post.pdf}
\bibitem{cs245-nd} Propositional Logic: Soundness and
Completeness for Natural Deduction. \url{https://cs.uwaterloo.ca/~cbruni/CS245Resources/lectures/2018_Fall/09_Propositional_Logic_Natural_Deduction_Soundness_and_Completeness_post.pdf}
\bibitem{FP-pap} Lecture Notes on Proofs as Programs. \url{http://www.cs.cmu.edu/~fp/courses/15816-s10/lectures/02-pap.pdf}
\bibitem{15-816-ciom} Computational Interpretations of Modalities
\url{http://www.cs.cmu.edu/~fp/courses/15816-s10/lectures/04-compmodal.pdf}
\end{thebibliography}
\end{document}